---
## Communicability Distance Matrix

To implement the novel hybrid measure, we first need to compute the communicability distance matrix. This will provide the foundation for analysing the effectiveness of the new measure and for comparing the communicability shortest path distance with the regular shortest path distance.

### **Definition — Communicability Distance Matrix**

Let $G=(V,E)$ be a network, and let

$$
S=[C_{11},C_{22},\cdots,C_{nn}]^T
$$

Where \( S \) is a column vector of the self communicabilities of every node in the network. Let

$$
D=S\mathbf{e}^T+\mathbf{e}S^T-2C
$$

With:

 - The communicability function matrix defined as:
 
  $$
  C=\left(C_{pq}\right)_{1\leq p,q \leq n}=\text{exp}(A)
  $$
  
- and the following column vector of ones:
  
  $$\mathbf{e}=\mathbf{1}_{n\times 1}=[ 1,1,\cdots,1 ]^T$$  

The communicability distance matrix of the network \( G \) is then given by:

$$
\overline{C}(G)=\sqrt[0]{D}
$$

Where $\sqrt[0]{}$ is the component-wise square root.

---

## Strategy Implementation Road Map

Using the definition above and considering the fact that in a transport network, the shortest path is not necessarily the most efficient path either in terms of travelling time, congestion or environmental impact, we suggest the following road map:

### a) **Implementation of the Communicability Distance in Python**

The first step consists of implementing the communicability distance function in Python.  
The implemented algorithm is given below:

####   **Algorithm 1: Communicability Distance Matrix — Heat-map Visualisation**
<p align="center">
  <img src="Miscellaneous/Alg1_2025-11-13_120314.png">
</p>

### b) **Compare the shortest path distances**

Subsequently, we suggest comparing the **communicability shortest-path distance** with the **regular shortest-path distance** obtained using **Dijkstra’s algorithm**.


### **Algorithm — Dijkstra’s Algorithm (Single Source)**  

<p align="center">
  <img src="Miscellaneous/Alg2_2025-11-13 120414.png">
</p

### c) Comparison between any two pairs of nodes

For any two pair of nodes where the source node has been previously defined, we want to compare the length of the shortest path generated by the **communicability shortest path** with that of the **regular shortest path**.

---

### d) Produce comparative graphs

This step consists of generating visuals that illustrate the difference in proportion between the communicability shortest path and the regular shortest path distance.

---

### e) Analyse the results

This step consists of analysing the results obtained from various networks and defining a rewiring strategy that will improve the overall network efficiency — not only in terms of shortest-path distance but also in terms of **communicability**.

---

## Implementation of the hybrid measure of network distance

In order to compute the novel hybrid metric (as defined earlier), we need to normalise the contribution of each of the metrics as follows:

$$
\widetilde{d_{pq}} = \frac{d_{pq}}{\max_{p,q}(d_{pq})}
\qquad
\widetilde{d_{co_2}}(p,q) = \frac{d_{co_2}(p,q)}{\max_{p,q}(d_{co_2}(p,q))}
\qquad
\widetilde{C_{pq}} = \frac{C_{pq}}{\max_{p,q}(C_{pq})}
$$

Hence, the hybrid distance becomes:

$$
\widetilde{H_{pq}}= \alpha\,\widetilde{d_{pq}}+ \beta\,\widetilde{d_{co_2}}(p,q)+ \gamma\,\widetilde{C_{pq}}
$$

In addition, we also need to compute the **shortest path distance matrix**, which yields the shortest path distances between any pair of nodes in the network.  
This is achieved using the **Floyd–Warshall all-pairs shortest paths algorithm**:

---
### Algorithm — Floyd–Warshall Algorithm for All-Pairs Shortest Path

<p align="center">
  <img src="Miscellaneous/Alg3_2025-11-13 120505.png">
</p

#### Rewiring strategy

Let $G = (V, E)$ be the original network, where $V$ and $E$ represent respectively the sets of nodes and the set of edges.  
We have two shortest-path node–frequency distributions:

- $\widetilde{f}_{C}(V)$: the frequency distribution of the nodes $v_i$ in the **communicability shortest paths**
- $\widetilde{f}_{R}(V)$: the frequency distribution of the nodes $v_i$ in the **regular shortest paths**

From our simulation outputs, it is evident that for all $1 \leq p, q \leq n$:

$$
|C_{pq}| \ge |d_{pq}|
$$

Our goal is to modify the two distributions:
- $\widetilde{f}_{C}(V)$, 
- $\widetilde{f}_{R}(V)$

so that they match as closely as possible, mathematically this reads:

$$
\forall \epsilon \ge 0,\ \forall v_i \in V,\quad 
\left| \widetilde{f}_{C}(v_i) - \widetilde{f}_{R}(v_i) \right| \le \epsilon
$$

subject to the following constraints:

$$
\begin{cases}
(i):\ \dfrac{\partial |V|}{\partial t} = \dfrac{\partial |E|}{\partial t} = 0, \\
(ii):\ \forall (u', v') \in V' \times V',\ \exists\, P(u', v') \in E'
\end{cases}
$$

Condition **(i)** ensures that the number of nodes and edges remains constant,  
and condition **(ii)** ensures that the rewired graph $G' = (V', E')$ remains **connected**.

---
## Implementation of the rewiring strategy

To implement the rewiring strategy described above, we first need to design an algorithm that satisfies all structural constraints of the problem.  
Let $A$ be the adjacency matrix of the initial network that we aim to optimise.

Our objective is to generate a **new network** by modifying the initial adjacency matrix $A$, while ensuring that:

- The generated network $G' = (V', E')$ remains **connected**
- The numbers of nodes and edges remain unchanged, i.e.,  
  $|V| = |V'|$ and $|E| = |E'|$

Taking these constraints into account, the complete implementation algorithm of the rewiring strategy is presented below under the following hypotheses:
#### Assumption

In real-world scenarios, it is often impractical to establish connections or add edges between every pair of nodes, particularly in **road transportation** networks.
However, for the purposes of this project, we assume the feasibility of adding or removing edges between pairs of nodes within a given transport network.  
This assumption is more realistic for **airline transportation networks**, where long-range connections are more flexible and less physically constrained.

### Algorithm — Implementation of the Rewiring Strategy

<p align="center">
  <img src="Miscellaneous/Alg4_2025-11-13 120505.png">
</p

This algorithm ensures that the rewired network structure moves toward an equilibrium where:

- communicability-based frequency
  
   $$\widetilde{f}_{C} (v_i)$$

matches

- regular shortest-path frequency
  
  $$\widetilde{f}_{R} (v_i)$$
  
as closely as possible, while preserving the **connectivity** and **size** of the network.



